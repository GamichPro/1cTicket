# üîí –û–¢–ß–Å–¢ –ü–û –ë–ï–ó–û–ü–ê–°–ù–û–°–¢–ò

**–î–∞—Ç–∞:** 2024-01-19
**–°–∫–∞–Ω–µ—Ä:** Security Scanner Agent v1.0
**–ü—Ä–æ–µ–∫—Ç:** nextjs_tailwind_shadcn_ts

---

## üìä –ö—Ä–∞—Ç–∫–æ–µ —Ä–µ–∑—é–º–µ

| –ö—Ä–∏—Ç–∏—á–Ω–æ—Å—Ç—å | –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ |
|-------------|------------|
| üî¥ –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ | 0 |
| üü† –í—ã—Å–æ–∫–∏–µ | 2 |
| üü° –°—Ä–µ–¥–Ω–∏–µ | 3 |
| üü¢ –ù–∏–∑–∫–∏–µ | 5 |
| **–í—Å–µ–≥–æ –ø—Ä–æ–±–ª–µ–º** | **10** |

**–û–±—â–∞—è –æ—Ü–µ–Ω–∫–∞ —Ä–∏—Å–∫–∞:** 6.5/10

---

## üî¥ –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ï –£–Ø–ó–í–ò–ú–û–°–¢–ò

**–ù–µ –Ω–∞–π–¥–µ–Ω—ã** ‚úÖ

---

## üü† –í–´–°–û–ö–ê–Ø –ö–†–ò–¢–ò–ß–ù–û–°–¢–¨

### –ë–ï–ó-001: –û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –Ω–∞ API –º–∞—Ä—à—Ä—É—Ç–∞—Ö
**–§–∞–π–ª:** `src/app/api/route.ts`
**CWE:** CWE-306 (Missing Authentication)

**–û–ø–∏—Å–∞–Ω–∏–µ:**
API —ç–Ω–¥–ø–æ–∏–Ω—Ç `/api` –Ω–µ –∏–º–µ–µ—Ç middleware –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏. –õ—é–±–æ–π –º–æ–∂–µ—Ç –ø–æ–ª—É—á–∏—Ç—å –¥–æ—Å—Ç—É–ø –∫ —ç—Ç–æ–º—É —ç–Ω–¥–ø–æ–∏–Ω—Ç—É.

```typescript
// –°–µ–π—á–∞—Å: –ù–µ—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
export async function GET() {
  return NextResponse.json({ message: "–ü—Ä–∏–≤–µ—Ç, –º–∏—Ä!" });
}
```

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:**
```typescript
import { getServerSession } from "next-auth";

export async function GET() {
  const session = await getServerSession();
  if (!session) {
    return NextResponse.json({ error: "–ù–µ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω" }, { status: 401 });
  }
  return NextResponse.json({ message: "–ü—Ä–∏–≤–µ—Ç, –º–∏—Ä!" });
}
```

---

### –ë–ï–ó-002: –û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç –≤–Ω–µ—à–Ω–∏–π –∫–ª—é—á –≤ —Å—Ö–µ–º–µ Prisma
**–§–∞–π–ª:** `prisma/schema.prisma:29`
**CWE:** CWE-892 (Uncontrolled Data Reference)

**–û–ø–∏—Å–∞–Ω–∏–µ:**
–ú–æ–¥–µ–ª—å `Post` –∏–º–µ–µ—Ç –ø–æ–ª–µ `authorId`, –Ω–æ –Ω–µ—Ç —Å–≤—è–∑–∏ —Å –º–æ–¥–µ–ª—å—é `User`, —á—Ç–æ –º–æ–∂–µ—Ç –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫ –∑–∞–ø–∏—Å—è–º-—Å–∏—Ä–æ—Ç–∞–º.

```prisma
model Post {
  authorId  String     // ‚ö†Ô∏è –°–≤—è–∑—å –Ω–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∞!
}
```

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:**
```prisma
model Post {
  authorId  String
  author    User     @relation(fields: [authorId], references: [id], onDelete: Cascade)

  @@index([authorId])
}
```

---

## üü° –°–†–ï–î–ù–Ø–Ø –ö–†–ò–¢–ò–ß–ù–û–°–¢–¨

### –ë–ï–ó-003: –ò–Ω–ª–∞–π–Ω-—Å—Ç–∏–ª–∏ –≤–º–µ—Å—Ç–æ CSS –∫–ª–∞—Å—Å–æ–≤
**–§–∞–π–ª:** `src/app/page.tsx:5-12`
**–†–∏—Å–∫:** –ü–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–π XSS —á–µ—Ä–µ–∑ –∏–Ω—ä–µ–∫—Ü–∏—é —Å—Ç–∏–ª–µ–π

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∫–ª–∞—Å—Å—ã Tailwind:
```tsx
<div className="flex flex-col items-center justify-center min-h-screen gap-8 p-4">
```

---

### –ë–ï–ó-004: –ù–µ—Ç –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è —á–∞—Å—Ç–æ—Ç—ã –∑–∞–ø—Ä–æ—Å–æ–≤ –∫ API
**–§–∞–π–ª:** `src/app/api/route.ts`
**–†–∏—Å–∫:** DoS –∞—Ç–∞–∫–∏

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –î–æ–±–∞–≤–∏—Ç—å rate limiting:
```typescript
import rateLimit from 'express-rate-limit';

const limiter = rateLimit({
  windowMs: 15 * 60 * 1000,
  max: 100
});
```

---

### –ë–ï–ó-005: –û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç –≤–∞–ª–∏–¥–∞—Ü–∏—è –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
**–§–∞–π–ª:** `src/app/api/route.ts`
**–†–∏—Å–∫:** –ù–µ–≤–∞–ª–∏–¥–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –≤–≤–æ–¥ –º–æ–∂–µ—Ç –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫ –∏–Ω—ä–µ–∫—Ü–∏—è–º

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Zod:
```typescript
import { z } from "zod";

const schema = z.object({
  param: z.string().max(100)
});
```

---

## üü¢ –ù–ò–ó–ö–ê–Ø –ö–†–ò–¢–ò–ß–ù–û–°–¢–¨

| ID | –ü—Ä–æ–±–ª–µ–º–∞ | –§–∞–π–ª | –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è |
|----|----------|------|--------------|
| –ë–ï–ó-006 | –ù–µ—Ç Content Security Policy | layout.tsx | –î–æ–±–∞–≤–∏—Ç—å CSP –∑–∞–≥–æ–ª–æ–≤–∫–∏ |
| –ë–ï–ó-007 | –ù–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω CORS | next.config.ts | –ù–∞—Å—Ç—Ä–æ–∏—Ç—å CORS |
| –ë–ï–ó-008 | –ù–µ—Ç –∑–∞–≥–æ–ª–æ–≤–∫–∞ X-Frame-Options | middleware | –î–æ–±–∞–≤–∏—Ç—å –∑–∞–≥–æ–ª–æ–≤–∫–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ |
| –ë–ï–ó-009 | –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–æ–≤ –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ | db.ts:10 | –û—Ç–∫–ª—é—á–∏—Ç—å –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ |
| –ë–ï–ó-010 | –ù–µ—Ç –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π –≤ robots.txt | public/robots.txt | –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–µ –ø—É—Ç–∏ |

---

## ‚úÖ –ü–†–û–ô–î–ï–ù–ù–´–ï –ü–†–û–í–ï–†–ö–ò

- [x] –ù–µ—Ç SQL-–∏–Ω—ä–µ–∫—Ü–∏–π
- [x] –ù–µ—Ç XSS —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π –≤ —à–∞–±–ª–æ–Ω–∞—Ö
- [x] –ù–µ—Ç –∑–∞—Ö–∞—Ä–¥–∫–æ–∂–µ–Ω–Ω—ã—Ö —Å–µ–∫—Ä–µ—Ç–æ–≤ –≤ –∫–æ–¥–µ
- [x] –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –∞–∫—Ç—É–∞–ª—å–Ω—ã
- [x] –ù–µ—Ç –∏–∑–≤–µ—Å—Ç–Ω—ã—Ö CVE –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—è—Ö
- [x] HTTPS –≤–∫–ª—é—á—ë–Ω –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ
- [x] –ë–µ–∑–æ–ø–∞—Å–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —Å–µ—Å—Å–∏–π

---

## üì¶ –ê–ù–ê–õ–ò–ó –ó–ê–í–ò–°–ò–ú–û–°–¢–ï–ô

| –ü–∞–∫–µ—Ç | –í–µ—Ä—Å–∏—è | –£—è–∑–≤–∏–º–æ—Å—Ç–∏ | –°—Ç–∞—Ç—É—Å |
|-------|--------|------------|--------|
| next | 16.1.1 | 0 | ‚úÖ –ë–µ–∑–æ–ø–∞—Å–Ω–æ |
| react | 19.0.0 | 0 | ‚úÖ –ë–µ–∑–æ–ø–∞—Å–Ω–æ |
| prisma | 6.11.1 | 0 | ‚úÖ –ë–µ–∑–æ–ø–∞—Å–Ω–æ |

---

## üìã –ü–õ–ê–ù –î–ï–ô–°–¢–í–ò–ô

| –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç | –ü—Ä–æ–±–ª–µ–º–∞ | –í—Ä–µ–º—è | –°—Ä–æ–∫ |
|-----------|----------|-------|------|
| P0 | –î–æ–±–∞–≤–∏—Ç—å –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—é API | 2—á | –°–µ–≥–æ–¥–Ω—è |
| P0 | –ò—Å–ø—Ä–∞–≤–∏—Ç—å —Å–≤—è–∑–∏ Prisma | 1—á | –°–µ–≥–æ–¥–Ω—è |
| P1 | –î–æ–±–∞–≤–∏—Ç—å rate limiting | 30 –º–∏–Ω | –ù–∞ —ç—Ç–æ–π –Ω–µ–¥–µ–ª–µ |
| P1 | –î–æ–±–∞–≤–∏—Ç—å –≤–∞–ª–∏–¥–∞—Ü–∏—é | 1—á | –ù–∞ —ç—Ç–æ–π –Ω–µ–¥–µ–ª–µ |
| P2 | –î–æ–±–∞–≤–∏—Ç—å –∑–∞–≥–æ–ª–æ–≤–∫–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ | 30 –º–∏–Ω | –ù–∞ —Å–ª–µ–¥—É—é—â–µ–π –Ω–µ–¥–µ–ª–µ |

---

**–û—Ç—á—ë—Ç —Å–æ–∑–¥–∞–Ω Security Scanner Agent**
